{"version":3,"sources":["webpack:///./src/components/modules/video/VideoModule.vue?af32","webpack:///./src/components/modules/video/VideoStream.vue?6d67","webpack:///src/components/modules/video/VideoStream.vue","webpack:///./src/components/modules/video/VideoStream.vue?5831","webpack:///./src/components/modules/video/VideoStream.vue","webpack:///src/components/modules/video/VideoModule.vue","webpack:///./src/components/modules/video/VideoModule.vue?414c","webpack:///./src/components/modules/video/VideoModule.vue","webpack:///./node_modules/sdp/sdp.js","webpack:///./node_modules/events/events.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","navColor","_v","_l","stream","key","_s","name","model","value","callback","$$v","$set","expression","Object","keys","videostreams","length","_e","ref","refInFor","streamStatus","action","cleanBitrate","statBitrate","statPacketloss","url","webrtcEndpoint","refWidth","on","$event","updateStatus","updatePacketloss","updateBitrate","staticRenderFns","videostream","width","domProps","props","config","type","default","Number","String","data","lastStats","streaming","watch","handler","logDebug","start","stremaing","pause","stop","beforeDestroy","clearInterval","bitrateInterval","bufferingInterval","mounted","setInterval","$emit","janus","connect","then","addPlugin","peerConnection","onicecandidate","event","candidate","sdpMid","sdpMLineIndex","onaddstream","videoElement","srcObject","mediaStreamEvent","play","lastPosition","currentTime","paused","setRemoteDescription","RTCSessionDescription","jsep","createAnswer","setLocalDescription","answer","methods","component","components","VideoStream","actionState","bitrate","resolution","activeStream","computed","$store","state","window","addEventListener","changeStream","Math","round","$refs","el","clientWidth","VAlert","VBtn","VCard","VCardText","VCardTitle","VChip","VCol","VContainer","VContent","VIcon","VLayout","VRow","VSpacer","VSwitch","VSystemBar","VToolbar","VToolbarTitle","SDPUtils","random","toString","substr","localCName","generateIdentifier","splitLines","blob","trim","split","map","line","splitSections","parts","part","index","getDescription","sections","getMediaSections","shift","matchPrefix","prefix","filter","indexOf","parseCandidate","substring","foundation","parseInt","protocol","toLowerCase","priority","ip","address","port","i","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","writeCandidate","sdp","push","toUpperCase","join","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","channels","numChannels","writeRtpMap","codec","pt","undefined","preferredPayloadType","parseExtmap","id","direction","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","params","forEach","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","slice","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","kind","caps","maxptime","extension","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","obj","cname","rsize","reducedSize","compound","mux","parseMsid","spec","track","planB","msidParts","parseSctpDescription","maxMessageSize","parseMLine","maxSizeLine","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","sctp","output","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","sessionId","version","user","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","rtpSender","rtpReceiver","msid","sendEncodingParameters","getDirection","getKind","isRejected","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","charAt","module","exports","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ProcessEmitWarning","warning","console","warn","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","EventEmitter","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","prepend","m","events","existing","create","newListener","emit","unshift","warned","w","Error","emitter","count","onceWrapper","fired","removeListener","wrapFn","arguments","_onceWrap","wrapped","bind","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","listenerCount","arr","n","copy","Array","spliceOne","list","pop","ret","defineProperty","enumerable","get","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","len","listeners","addListener","prependListener","once","prependOnceListener","position","originalListener","off","removeAllListeners","rawListeners","eventNames"],"mappings":"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","file":"js/VideoModule.0d642fbe.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-content',[_c('v-container',[_c('v-card',{staticClass:\"mx-auto\"},[_c('v-toolbar',{attrs:{\"color\":_vm.navColor,\"dense\":\"\"}},[_c('v-toolbar-title',[_vm._v(\"Video Streams\")]),_c('v-spacer'),_c('v-btn',{attrs:{\"to\":\"/config/video\",\"color\":_vm.navColor}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-plus\")]),_c('span',[_vm._v(\"configure\")])],1)],1),_c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',{attrs:{\"dense\":\"\"}},_vm._l((_vm.videostreams),function(stream){return _c('v-col',{key:stream.key,attrs:{\"xs\":\"12\",\"sm\":\"12\",\"md\":\"6\",\"lg\":\"6\",\"xl\":\"6\"}},[_c('v-card',{staticClass:\"mx-auto\",attrs:{\"raised\":\"\"}},[_c('v-card-title',{staticClass:\"headline\"},[_c('span',[_vm._v(_vm._s(stream.name))]),_c('v-spacer'),_c('v-switch',{attrs:{\"color\":\"green\",\"label\":(stream.enabled) ? 'Enabled' : 'Disabled'},model:{value:(stream.enabled),callback:function ($$v) {_vm.$set(stream, \"enabled\", $$v)},expression:\"stream.enabled\"}})],1)],1)],1)}),1),(!Object.keys(_vm.videostreams).length)?_c('v-alert',{attrs:{\"outlined\":\"\",\"border\":\"left\",\"type\":\"warning\"}},[_c('span',[_vm._v(\"No Video Streams are defined. Please define a video stream in \"),_c('v-btn',{attrs:{\"to\":\"/config/video\"}},[_vm._v(\"Config->Video\")])],1)]):_vm._e()],1)],1)],1),_c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',{attrs:{\"dense\":\"\"}},_vm._l((_vm.videostreams),function(stream){return (stream.enabled)?_c('v-col',{key:stream.key,attrs:{\"xs\":\"12\",\"sm\":\"12\",\"md\":\"12\",\"lg\":\"6\",\"xl\":\"6\"}},[_c('v-layout',{ref:'layout-'+stream.key,refInFor:true,attrs:{\"justify-center\":\"\",\"wrap\":\"\"}},[_c('v-card',{staticClass:\"mx-auto\"},[_c('v-system-bar',{attrs:{\"color\":_vm.navColor,\"window\":\"\"}},[_c('span',[_vm._v(\"Video Stream: \"+_vm._s(stream.name))])]),_c('v-card-text',[(_vm.streamStatus[stream.key]=='playing')?_c('v-chip',{staticClass:\"ma-2\",attrs:{\"color\":\"green\"}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-check-circle\")]),_c('span',[_vm._v(\"Playing\")])],1):(_vm.streamStatus[stream.key]=='buffering' || stream.action == 'stop')?_c('v-chip',{staticClass:\"ma-2\",attrs:{\"color\":\"amber\"}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-alert\")]),_c('span',[_vm._v(\"Buffering\")])],1):_c('v-chip',{staticClass:\"ma-2\",attrs:{\"color\":\"red\"}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-alert-circle\")]),_c('span',[_vm._v(\"Stopped\")])],1),_c('span',[_vm._v(\"Bitrate\"),_c('v-chip',{staticClass:\"ma-2\",attrs:{\"color\":\"blue\"}},[_c('strong',[_vm._v(_vm._s(_vm.cleanBitrate(_vm.statBitrate[stream.key])))])])],1),_c('span',[_vm._v(\"Packet Loss\"),_c('v-chip',{staticClass:\"ma-2\",attrs:{\"color\":\"red\"}},[_c('strong',[_vm._v(_vm._s(_vm.statPacketloss[stream.key]))])])],1)],1),_c('VideoStream',{attrs:{\"config\":{ url: stream.webrtcEndpoint },\"videostream\":stream.key,\"width\":_vm.refWidth('layout-'+stream.key),\"stream\":1,\"action\":stream.action},on:{\"status\":function($event){return _vm.updateStatus(stream.key, $event)},\"packetloss\":function($event){return _vm.updatePacketloss(stream.key, $event)},\"bitrate\":function($event){return _vm.updateBitrate(stream.key, $event)}}})],1)],1)],1):_vm._e()}),1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('video',{staticClass:\"ma2 pa0\",attrs:{\"id\":_vm.videostream,\"controls\":\"\",\"autoPictureInPicture\":\"\",\"muted\":\"\",\"preload\":\"none\",\"poster\":\"/img/placeholders/video-placeholder.png\",\"width\":_vm.width},domProps:{\"muted\":true}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang='pug'>\n  video.ma2.pa0(:id='videostream' controls autoPictureInPicture=true muted=true preload=\"none\" poster=\"/img/placeholders/video-placeholder.png\" :width=\"width\")\n</template>\n\n<script>\n/* Note: you may need to add `externals: { ws: \"WebSocket\"},` to Your webpack configuration for this to work properly */\nimport { Janus, StreamingJanusPlugin } from '@techteamer/janus-api'\n\nexport default {\n  props: {\n    config: {\n      type: Object,\n      default: null\n    },  \n    stream: {\n      type: Number,\n      default: null\n    },\n    width: {\n      type: Number,\n      default: 500\n    },\n    videostream: {\n      type: String,\n      default: null\n    },\n    action: {\n      type: String,\n      default: null\n    }\n  },\n\n  data () {\n    return {\n      lastStats: null,\n      streaming: null\n    }\n  },\n\n  watch: {\n    action: {\n      handler: function (newValue) {\n        this.logDebug(`action: ${newValue}, ${this.action}`)\n        if (this.action == 'start') {\n          this.streaming.start()\n        } else if (this.action == 'pause') {\n          this.stremaing.pause()\n        } else if (this.action == 'stop') {\n          this.streaming.stop()\n        }\n      }\n    }\n  },\n\n  beforeDestroy () {\n    clearInterval(this.bitrateInterval)\n    clearInterval(this.bufferingInterval)\n  },\n  \n  mounted () {\n    let janus = this.janus = new Janus(this.config, console)\n    this.streaming = new StreamingJanusPlugin(console, false)\n    let peerConnection = new RTCPeerConnection()\n    let bitrate = 0\n    let packetloss = 0\n    this.bitrateInterval = setInterval(() => {\n\n    let selector = peerConnection.getReceivers().find(({kind}) => kind == \"video\");\n    peerConnection.getStats(selector).then((stats => stats.forEach(entry => {\n        if (entry.type == \"inbound-rtp\") {\n          if (this.lastStats) {\n            packetloss = entry.packetsLost\n            bitrate = (entry.bytesReceived - this.lastStats.bytesReceived) / (entry.lastPacketReceivedTimestamp - this.lastStats.lastPacketReceivedTimestamp)\n          }\n          this.lastStats = entry\n        }\n      })))\n      this.$emit('bitrate', bitrate)\n      this.$emit('packetloss', packetloss)\n    }, 1000)\n\n    this.$emit('status', 'init')\n    janus.connect().then(() => {\n      return janus.addPlugin(this.streaming)\n    }).then(() => {\n      // console.info('plugin added', janus)\n      peerConnection.onicecandidate = (event) => {\n        // console.log('@onicecandidate', event)\n        if (!event.candidate || !event.candidate.candidate) {\n          this.streaming.candidate({completed: true})\n        } else {\n          this.streaming.candidate({\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex\n          })\n        }\n      }\n      peerConnection.onaddstream = (mediaStreamEvent) => {\n        let videoElement = document.getElementById(this.videostream)\n        videoElement.srcObject = mediaStreamEvent.stream\n        videoElement.play()\n        if (this.bufferingInterval == undefined) {\n          let lastPosition = 0\n          this.bufferintInterval = setInterval(() => {\n            if (lastPosition == videoElement.currentTime && !videoElement.paused) {\n              this.$emit('status', 'buffering')\n            } else {\n              this.$emit('status', 'playing')\n            }\n            lastPosition = videoElement.currentTime\n          }, 500)\n        }\n      }\n      // streaming.on('webrtcState', (a, b) => { console.log('webrtcState', a, b) })\n      // streaming.on('mediaState', (a, b) => { console.log('mediaState', a, b) })\n      this.streaming.on('statusChange', (status) => {\n        // console.log('statusChange', status)\n        this.$emit('status', status)\n      })\n      return this.streaming.watch(this.stream)\n    }).then((jsep) => {\n      return peerConnection.setRemoteDescription(new RTCSessionDescription(jsep))\n    }).then(() => {\n      // console.log('remoteDescription set')\n      return peerConnection.createAnswer({offerToReceiveAudio: true, offerToReceiveVideo: true})\n    }).then(answer => {\n      // console.log('answerCreated', answer)\n      peerConnection.setLocalDescription(answer)\n      return this.streaming.start(answer)\n    }).then(({body, json}) => {\n      // console.log('START', body, json)\n    })\n  },\n\n  methods: {\n\n  }\n}\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoStream.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoStream.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VideoStream.vue?vue&type=template&id=cb83b216&lang=pug&\"\nimport script from \"./VideoStream.vue?vue&type=script&lang=js&\"\nexport * from \"./VideoStream.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template lang='pug'>\nv-content\n\n  v-container\n    v-card.mx-auto\n      v-toolbar(:color=\"navColor\" dense)\n        v-toolbar-title Video Streams\n        v-spacer\n        v-btn(to='/config/video' :color=\"navColor\")\n          v-icon(left) mdi-plus\n          span configure\n      v-container(fluid)\n        v-row(dense)\n          v-col(v-for=\"stream in videostreams\" :key=\"stream.key\" xs=12 sm=12 md=6 lg=6 xl=6)\n            v-card(raised).mx-auto\n              v-card-title.headline\n                span {{ stream.name }}\n                v-spacer\n                v-switch(color='green' v-model='stream.enabled' :label=\"(stream.enabled) ? 'Enabled' : 'Disabled'\")               \n        v-alert(v-if=\"!Object.keys(videostreams).length\" outlined border=\"left\" type=\"warning\")\n          span No Video Streams are defined.  Please define a video stream in <v-btn to='/config/video'>Config->Video</v-btn>\n\n  v-container(fluid)\n      v-row(dense)\n\n        v-col(v-for=\"stream in videostreams\" :key='stream.key' v-if=\"stream.enabled\" xs=12 sm=12 md=12 lg=6 xl=6)\n          v-layout(justify-center wrap :ref=\"'layout-'+stream.key\")\n            v-card.mx-auto()\n              v-system-bar(:color=\"navColor\" window)\n                span Video Stream: {{ stream.name }}\n              v-card-text\n                v-chip.ma-2(v-if=\"streamStatus[stream.key]=='playing'\" color='green')\n                  v-icon(left) mdi-check-circle\n                  span Playing\n                v-chip.ma-2(v-else-if=\"streamStatus[stream.key]=='buffering' || stream.action == 'stop'\" color='amber')\n                  v-icon(left) mdi-alert\n                  span Buffering\n                v-chip.ma-2(v-else color='red')\n                  v-icon(left) mdi-alert-circle\n                  span Stopped\n                span Bitrate\n                  v-chip.ma-2(color='blue') <strong>{{ cleanBitrate(statBitrate[stream.key]) }}</strong>\n                span Packet Loss\n                  v-chip.ma-2(color='red') <strong>{{ statPacketloss[stream.key] }}</strong>\n              VideoStream(:config=\"{ url: stream.webrtcEndpoint }\" :videostream=\"stream.key\" :width=\"refWidth('layout-'+stream.key)\" :stream=\"1\" :action=\"stream.action\" @status=\"updateStatus(stream.key, $event)\" @packetloss=\"updatePacketloss(stream.key, $event)\" @bitrate=\"updateBitrate(stream.key, $event)\")\n              // v-card-text\n                v-layout.d-flex.justify-space-between(flat)\n                  // div\n                    v-btn-toggle.ma-2(v-model=\"actionState\" shaped mandatory dense)\n                      v-btn(color='green' @click=\"stream.action='start'\")\n                        v-icon(left) mdi-play\n                        span Start\n                      v-btn(color='red' @click=\"stream.action='stop'\")\n                        v-icon(left) mdi-stop\n                        span Stop\n                // span BitRate\n                  v-btn-toggle.ma-2(v-model=\"bitrate\" mandatory background-color='blue' active-class='blue' dense)\n                    v-btn(value='128') 128K\n                    v-btn(value='256') 256K\n                    v-btn(value='512') 512K\n                    v-btn(value='1024') 1M\n                    v-btn(value='2048') 2M\n\n                // div\n                  span Resolution\n                  v-btn-toggle.ma-2(v-model=\"resolution\" mandatory background-color='purple' active-class='purple' dense)\n                    v-btn(value='480p') 480p\n                    v-btn(value='720p') 720p\n                    v-btn(value='1080p') 1080p\n                    v-btn(value='2k') 2k\n                    v-btn(value='4k') 4k\n\n</template>\n\n<script>\nimport VideoStream from './VideoStream.vue'\n\nexport default {\n  name: 'VideoModule',\n  components: {\n    VideoStream\n  },\n  data () {\n    return {\n      actionState: 'start',\n      streamStatus: {'nano': null, 'raspberry': null},\n      statBitrate: {'nano': null, 'raspberry': null},\n      statPacketloss: {'nano': null, 'raspberry': null},\n      bitrate: '256',\n      resolution: '720p',\n      activeStream: null,\n      width: 500\n    }\n  },\n  computed: {\n    videostreams () {\n      return this.$store.state.data.videostreams\n    }\n  },\n  watch: {\n  },\n  mounted () {\n    window.addEventListener('resize', () => {\n      this.width = ((75 / 100) * window.innerWidth)\n    })\n  },\n  methods: {\n    updateStatus (key, $event) {\n      if (!(this.streamStatus.hasOwnProperty(key))) {\n        this.$set(this.streamStatus, key, $event)\n      } else {\n        this.streamStatus[key] = $event\n      }\n    },\n    updateBitrate (key, $event) {\n      if (!(this.statBitrate.hasOwnProperty(key))) {\n        this.$set(this.statBitrate, key, $event)\n      } else {\n        this.statBitrate[key] = $event\n      }\n    },\n    updatePacketloss (key, $event) {\n      if (!(this.statPacketloss.hasOwnProperty(key))) {\n        this.$set(this.statPacketloss, key, $event)\n      } else {\n        this.statPacketloss[key] = $event\n      }\n    },\n    changeStream (stream) {\n      this.activeStream = stream\n    },\n    cleanBitrate (bitrate) {\n      // console.log(bitrate)\n      if (bitrate / 1000 < 1000) {\n        return Math.round(bitrate / 1000) + ' K'\n      } else {\n        return Math.round(bitrate / 1000000) + ' M'\n      }\n    },\n    refWidth (el) {\n      let width = null\n      try {\n        width = this.$refs[el][0].clientWidth\n      } catch (err) {\n\n      }\n      return width\n    }\n  }\n}\n</script>\n\n<style scoped>\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoModule.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--20-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VideoModule.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./VideoModule.vue?vue&type=template&id=7251af48&scoped=true&lang=pug&\"\nimport script from \"./VideoModule.vue?vue&type=script&lang=js&\"\nexport * from \"./VideoModule.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7251af48\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAlert } from 'vuetify/lib/components/VAlert';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VChip } from 'vuetify/lib/components/VChip';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VContent } from 'vuetify/lib/components/VContent';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VLayout } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VSystemBar } from 'vuetify/lib/components/VSystemBar';\nimport { VToolbar } from 'vuetify/lib/components/VToolbar';\nimport { VToolbarTitle } from 'vuetify/lib/components/VToolbar';\ninstallComponents(component, {VAlert,VBtn,VCard,VCardText,VCardTitle,VChip,VCol,VContainer,VContent,VIcon,VLayout,VRow,VSpacer,VSwitch,VSystemBar,VToolbar,VToolbarTitle})\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substr(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES paramters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substr(12),\n    password: pwd.substr(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n"],"sourceRoot":""}